<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>To‚ÄëDo List üìù</title>
  <style>
    :root{
      --bg:#0f1220; --card:#171a2b; --muted:#8b90a8; --text:#e8ebff;
      --accent:#6c8cff; --accent-2:#4be1b0; --danger:#ff6b6b;
      --shadow: 0 8px 24px rgba(0,0,0,.35); --radius: 12px;
    }
    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      background: radial-gradient(1200px 800px at 80% -20%, #1c2040 0%, transparent 60%), var(--bg);
      color:var(--text); display:flex; justify-content:center; align-items:center; padding:24px;
    }
    .app{
      width:100%; max-width:720px; background:linear-gradient(180deg,#191d31,#14182a);
      border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden;
    }
    header{
      padding:20px 22px; border-bottom:1px solid rgba(255,255,255,.06);
      display:flex; align-items:center; gap:16px; flex-wrap:wrap; justify-content:space-between;
    }
    .title{ display:flex; align-items:center; gap:10px; font-weight:700; }
    .badge{ background: rgba(108,140,255,.15); color: var(--accent); padding:4px 10px; border-radius:999px; font-size:12px; }
    .controls{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .input{
      display:flex; align-items:center; gap:8px; background: var(--card); border:1px solid rgba(255,255,255,.07);
      padding:10px 12px; border-radius:10px; min-width:260px; flex:1;
    }
    .input input{ background:transparent; border:none; outline:none; color:var(--text); width:100%; font-size:16px; }
    .btn{
      background:var(--accent); color:#fff; border:none; padding:10px 14px; border-radius:10px;
      cursor:pointer; font-weight:600; transition:.2s transform,.2s filter; box-shadow:0 6px 16px rgba(108,140,255,.35);
    }
    .btn:hover{ filter:brightness(1.05); transform:translateY(-1px); }
    .btn.ghost{ background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,.10); box-shadow:none; }
    .btn.danger{ background:var(--danger); box-shadow:0 6px 16px rgba(255,107,107,.35); }
    .toolbar{
      padding:12px 16px; display:flex; align-items:center; justify-content:space-between; gap:12px;
      border-bottom:1px solid rgba(255,255,255,.06); background: linear-gradient(180deg, rgba(108,140,255,.08), transparent);
    }
    .filters{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
      padding:6px 10px; border-radius:999px; font-size:13px; cursor:pointer;
      border:1px solid rgba(255,255,255,.12); color:var(--muted); background:rgba(255,255,255,.02);
      transition:.2s background,.2s color,.2s border-color; user-select:none;
    }
    .chip.active{ background: rgba(108,140,255,.18); border-color: rgba(108,140,255,.6); color: var(--text); }
    .counter{ color: var(--muted); font-size:13px; }
    .list{ padding:10px 6px 6px; max-height:60vh; overflow:auto; }
    .empty{ text-align:center; color:var(--muted); padding:36px 16px; }
    .item{
      display:grid; grid-template-columns:34px 1fr auto; align-items:center; gap:10px;
      padding:10px 10px; margin:6px; border-radius:10px; background:var(--card);
      border:1px solid rgba(255,255,255,.07); transition: background .2s, border-color .2s;
    }
    .item:hover{ border-color: rgba(108,140,255,.45); }
    .item.completed{ opacity:.9; background: linear-gradient(180deg, #121627, #101425); }
    .check{ width:18px; height:18px; accent-color: var(--accent-2); cursor:pointer; }
    .text{ font-size:16px; line-height:1.4; word-break: break-word; }
    .text.completed{ text-decoration: line-through; color: var(--muted); }
    .actions{ display:flex; gap:6px; }
    .icon-btn{
      background: transparent; border:1px solid rgba(255,255,255,.12); color: var(--muted);
      padding:6px 8px; border-radius:8px; cursor:pointer; transition:.15s;
    }
    .icon-btn:hover{ color: var(--text); border-color: rgba(255,255,255,.25); }
    .edit-input{
      width:100%; background:#0f1324; color:var(--text); border:1px solid rgba(255,255,255,.2);
      border-radius:8px; padding:8px 10px; font-size:16px;
    }
    footer{
      padding:12px 16px; display:flex; justify-content:space-between; align-items:center; gap:12px;
      border-top:1px solid rgba(255,255,255,.06); color: var(--muted); font-size:13px; flex-wrap:wrap;
    }
    @media (max-width:640px){
      header{ flex-direction: column; align-items: stretch; }
      .controls{ width:100%; }
      .input{ width:100%; }
      .btn.add{ width:100%; }
      .toolbar{ flex-direction: column; align-items: stretch; }
      .filters{ justify-content: center; }
      footer{ flex-direction: column; align-items: flex-start; }
    }
  </style>
</head>
<body>
  <main class="app" role="application" aria-label="Lista de tarefas">
    <header>
      <div class="title">
        <h1 style="margin:0; font-size:20px;">To‚ÄëDo List üìù</h1>
        <span class="badge">offline ‚Ä¢ localStorage</span>
      </div>
      <div class="controls" role="group" aria-label="Adicionar tarefa">
        <div class="input">
          <span aria-hidden="true">‚ûï</span>
          <input id="newTask" type="text" placeholder="Escreva uma tarefa e tecle Enter‚Ä¶" autocomplete="off" />
        </div>
        <button class="btn add" id="addBtn" title="Adicionar tarefa">Adicionar</button>
      </div>
    </header>

    <section class="toolbar">
      <div class="filters" role="tablist" aria-label="Filtros">
        <button class="chip active" data-filter="all" role="tab" aria-selected="true">Todas</button>
        <button class="chip" data-filter="active" role="tab" aria-selected="false">Ativas</button>
        <button class="chip" data-filter="completed" role="tab" aria-selected="false">Conclu√≠das</button>
      </div>
      <div style="display:flex; gap:8px; align-items:center;">
        <span class="counter" id="counter">0 pendentes ‚Ä¢ 0 conclu√≠das ‚Ä¢ 0 total</span>
        <button class="btn ghost" id="toggleAll" title="Marcar tudo">Marcar tudo</button>
        <button class="btn danger" id="clearCompleted" title="Limpar conclu√≠das">Limpar conclu√≠das</button>
      </div>
    </section>

    <section class="list" id="list" aria-live="polite"></section>

    <footer>
      <div>üí° Dica: duplo clique no texto para editar.</div>
      <div>Seus dados ficam apenas neste navegador.</div>
    </footer>
  </main>

  <script>
    const $ = (s, root=document) => root.querySelector(s);
    const $$ = (s, root=document) => Array.from(root.querySelectorAll(s));

    const STORAGE_KEY = 'todo:list:v2';
    const state = { tasks: [], filter: 'all' };

    // Persist√™ncia
    function load(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        const data = raw ? JSON.parse(raw) : [];
        if(Array.isArray(data)) state.tasks = data;
      }catch(e){/* ignore */}
    }
    function save(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state.tasks));
    }

    // Utilidades
    const uid = () => Date.now().toString(36) + Math.random().toString(36).slice(2,7);

    function updateCounter(){
      const pend = state.tasks.filter(t => !t.completed).length;
      const done = state.tasks.length - pend;
      const total = state.tasks.length;
      $('#counter').textContent = `${pend} pendentes ‚Ä¢ ${done} conclu√≠das ‚Ä¢ ${total} total`;
    }

    function applyFilter(tasks){
      switch(state.filter){
        case 'active': return tasks.filter(t => !t.completed);
        case 'completed': return tasks.filter(t => t.completed);
        default: return tasks;
      }
    }

    function emptyBlock(){
      const div = document.createElement('div');
      div.className = 'empty';
      div.textContent = state.tasks.length ? 'Nada neste filtro.' : 'Nenhuma tarefa ainda. Comece adicionando uma acima.';
      return div;
    }

    // Renderiza√ß√£o
    function render(){
      const list = $('#list');
      list.innerHTML = '';
      const filtered = applyFilter(state.tasks);
      if(filtered.length === 0){
        list.appendChild(emptyBlock());
      } else {
        filtered.forEach(task => list.appendChild(renderItem(task)));
      }
      updateCounter();
    }

    function renderItem(task){
      const el = document.createElement('div');
      el.className = 'item' + (task.completed ? ' completed' : '');
      el.dataset.id = task.id;

      const check = document.createElement('input');
      check.type = 'checkbox';
      check.className = 'check';
      check.checked = task.completed;
      check.setAttribute('aria-label','Concluir tarefa');
      check.addEventListener('change', () => toggleCompleted(task.id, check.checked));

      const text = document.createElement('div');
      text.className = 'text' + (task.completed ? ' completed' : '');
      text.textContent = task.text;
      text.title = 'Duplo clique para editar';
      text.addEventListener('dblclick', () => startEdit(task.id, text));

      const actions = document.createElement('div');
      actions.className = 'actions';

      const editBtn = document.createElement('button');
      editBtn.className = 'icon-btn';
      editBtn.title = 'Editar';
      editBtn.textContent = '‚úèÔ∏è';
      editBtn.addEventListener('click', () => startEdit(task.id, text));

      const delBtn = document.createElement('button');
      delBtn.className = 'icon-btn';
      delBtn.title = 'Excluir';
      delBtn.textContent = 'üóëÔ∏è';
      delBtn.addEventListener('click', () => removeTask(task.id));

      actions.append(editBtn, delBtn);
      el.append(check, text, actions);
      return el;
    }

    // A√ß√µes
    function addTask(text){
      const trimmed = text.trim();
      if(!trimmed) return;
      state.tasks.unshift({ id: uid(), text: trimmed, completed: false });
      save(); render();
    }

    function removeTask(id){
      state.tasks = state.tasks.filter(t => t.id !== id);
      save(); render();
    }

    function toggleCompleted(id, value){
      const t = state.tasks.find(t => t.id === id);
      if(!t) return;
      t.completed = !!value;
      save(); render();
    }

    function updateText(id, text){
      const t = state.tasks.find(t => t.id === id);
      if(!t) return;
      t.text = text.trim() || t.text;
      save(); render();
    }

    function startEdit(id, textEl){
      const task = state.tasks.find(t => t.id === id);
      if(!task) return;

      const parent = textEl.parentElement;
      const input = document.createElement('input');
      input.className = 'edit-input';
      input.value = task.text;

      const finish = (commit=true) => {
        if(commit) updateText(id, input.value);
        else render();
      };

      input.addEventListener('keydown', (e) => {
        if(e.key === 'Enter') finish(true);
        if(e.key === 'Escape') finish(false);
      });
      input.addEventListener('blur', () => finish(true));

      parent.replaceChild(input, textEl);
      input.focus();
      input.setSelectionRange(input.value.length, input.value.length);
    }

    // Controles
    function bindUI(){
      const input = $('#newTask');
      const addBtn = $('#addBtn');

      addBtn.addEventListener('click', () => {
        addTask(input.value);
        input.value = '';
        input.focus();
      });

      input.addEventListener('keydown', (e) => {
        if(e.key === 'Enter'){
          addTask(input.value);
          input.value = '';
        }
      });

      // Filtros
      $$('.chip').forEach(chip => {
        chip.addEventListener('click', () => {
          $$('.chip').forEach(c => { c.classList.remove('active'); c.setAttribute('aria-selected','false'); });
          chip.classList.add('active');
          chip.setAttribute('aria-selected','true');
          state.filter = chip.dataset.filter;
          render();
        });
      });

      // Marcar tudo
      $('#toggleAll').addEventListener('click', () => {
        const allCompleted = state.tasks.length > 0 && state.tasks.every(t => t.completed);
        state.tasks = state.tasks.map(t => ({ ...t, completed: !allCompleted }));
        save(); render();
      });

      // Limpar conclu√≠das
      $('#clearCompleted').addEventListener('click', () => {
        if(!state.tasks.some(t => t.completed)) return;
        state.tasks = state.tasks.filter(t => !t.completed);
        save(); render();
      });
    }

    // Boot
    load();
    bindUI();
    render();
  </script>
</body>
</html>
